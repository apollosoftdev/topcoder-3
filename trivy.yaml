# Trivy configuration file
# https://aquasecurity.github.io/trivy/latest/docs/references/configuration/config-file/

# Scan settings
scan:
  # Skip directories that don't need scanning
  skip-dirs:
    - node_modules
    - .git
    - target
    - ssl

# License scanning settings
license:
  # Allowed licenses (permissive licenses)
  allowed:
    - Apache-2.0
    - MIT
    - BSD-2-Clause
    - BSD-3-Clause
    - ISC
    - EPL-1.0
    - EPL-2.0
    - MPL-2.0
    - CDDL-1.0
    - CDDL-1.1
    - Unlicense
    - CC0-1.0
    - 0BSD
    - Zlib
    - BSL-1.0
    - PostgreSQL
    - BlueOak-1.0.0
    - W3C
    - SAX-PD
    - Public Domain
    # Dual-licensed dependencies (classpath exception makes these permissive)
    - GPL-2.0-with-classpath-exception
    - GPL-2.0 WITH Classpath-exception-2.0
    - (GPL-2.0 OR CDDL-1.1)
    - (EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0)
    # LGPL variants (permissive for library usage)
    - LGPL-2.1-only
    - LGPL-2.1-or-later
    - LGPL-2.1
    - LGPL-2.1+
    - (EPL-1.0 OR LGPL-2.1-only)

# Vulnerability settings
vulnerability:
  # Ignore unfixed vulnerabilities
  ignore-unfixed: false

# Misconfiguration settings
misconfiguration:
  # Dockerfile checks
  include:
    - dockerfile
